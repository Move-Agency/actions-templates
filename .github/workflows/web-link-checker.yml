name: Check links
on:
  workflow_call:
    inputs:
        artifact-name:
          description: 'Name of the build artifact'
          default: 'build-20.x'
          required: false
          type: string

jobs:
    link-checker:
        permissions: {}
        runs-on: ubuntu-latest
        steps:
          - uses: actions/download-artifact@d3f86a106a0bac45b974a628896c90dbdf5c8093 # v4.3.0
            with:
              merge-multiple: true
              name: ${{ inputs.artifact-name }}
              path: out
    
          - name: Link Checker
            id: lychee
            uses: lycheeverse/lychee-action@5c4ee84814c983aa7164eaee476f014e53ff3963 # v2.5.0
            with:
              fail: true
              failIfEmpty: true
              args: --base out/ --verbose --no-progress --exclude 'videos\.ctfassets\.net' --exclude 'images\.ctfassets\.net' './**/*.html' 
